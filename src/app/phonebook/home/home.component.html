<div class="content">
    <div class="header">
        <div class="title_container">
            <img class="phone_book_icon" alt="phone book">
            <div>
                ContactBook
            </div>
        </div>

        <div class="search_and_profile">
            <input class="input_field" [(ngModel)]="searchString" (ngModelChange)="onSearchChange($event)" type="text"
                placeholder="Search contacts">
            <img (click)="profilePopup=true" class="profile_icon" alt="profile" height="34px" width="34px">
            <img (click)="logoutPopup=true" class="logout_icon" alt="logout" height="20px" width="20px">
        </div>

    </div>
    <div class="body_container">
        <div class="navigation_container">
            <div (click)="tabSelection('All Contacts')" class="selection_container"
                [class.selected]="selectedTab==='All Contacts'">
                <img class="all_contacts_icon" alt="all_contacts" height="25px" />
                <div style="padding-left: 10px;"> All Contacts</div>
                <div class="count">{{allcontactsCount}}</div>
            </div>

            <div (click)="tabSelection('Fav Contacts')" class="selection_container"
                [class.selected]="selectedTab==='Fav Contacts'">
                <img class="favourites_icon" alt="fav" height="20px" />
                <div style="padding-left: 10px;"> Favourites</div>
                <div class="count">{{favContactsCount}}</div>
            </div>

            <div (click)="tabSelection('Group Contacts')" class="selection_container"
                [class.selected]="selectedTab==='Group Contacts'">
                <img class="groups_icon" alt="all_contacts" height="20px" />
                <div style="padding-left: 10px;">Group</div>
                <div class="count">{{groupContactsCount}}</div>
            </div>
        </div>

        <div class="all_contacts_container">
            <div class="heading_container">
                <div class="heading">
                    {{mapHeading[selectedTab]}}
                </div>
                <div (click)="addFavPopup=true" style="margin-right: 20px; cursor: pointer;"
                    *ngIf="selectedTab==='Fav Contacts'">
                    Add
                </div>
            </div>

            <div class="contacts_list">
                <ng-container *ngFor="let profile of AlluserContacts">
                    <div (click)="viewContactDetails(profile)" class="contact_card">
                        <img class="user_profile" alt="profile_img" height="35px" width="35px">
                        <div class="card_details_container">
                            <div class="card_user_name">
                                {{profile.first_name}} {{profile.last_name}}
                            </div>
                            <div class="card_email">
                                {{profile.email}}
                            </div>
                            <div class="card_email" style="margin-top: 0px;">
                                {{profile.mobile_number}}
                            </div>
                            <div *ngIf="profile.group" class="card_user_groups">
                                {{profile.group}}
                            </div>
                        </div>
                        <div style="margin-left: 20px;" *ngIf="profile.is_favourite">
                            <img class="favourites_icon" alt="fav">
                        </div>
                    </div>
                </ng-container>
            </div>
            <div *ngIf="AlluserContacts.length>0" class="pagination-container">
                <button (click)="prevPage()" [disabled]="currentPage === 1">&laquo;</button>

                <span>Page {{ currentPage }} of {{ totalPages }}</span>

                <button (click)="nextPage()" [disabled]="currentPage === totalPages">&raquo;</button>
            </div>
        </div>
    </div>

    <div class="new_contact_conatiner">
        <img (click)="addContactPopup=true" class="newcontact_icon" alt="new Contact">
    </div>

    <div *ngIf="addContactPopup">
        <app-createcontact (popUpClose)="onPopupClose()"></app-createcontact>
    </div>

    <div class="popup-overlay" *ngIf="profilePopup">
        <div class="popup">
            <div class="popup_header">
                Profile
            </div>
            <div class="popup_body">
                <div class="display_message">
                    <div class="label">Name :</div>
                    <div class="label_value">{{user_details.first_name}} {{user_details.last_name}}</div>
                </div>
                <div class="display_message">
                    <div class="label">Email :</div>
                    <div class="label_value">{{user_details.email}}</div>
                </div>
                <div class="display_message">
                    <div class="label">Active :</div>
                    <div class="label_value">{{user_details.is_active}}</div>
                </div>
            </div>
            <button class="close_btn" (click)="profilePopup=false">Close</button>
        </div>
    </div>

    <div class="popup-overlay" *ngIf="addFavPopup">
        <div class="popup">
            <div class="popup_header">
                Favourites
            </div>
            <div class="popup_body">
                <ng-container *ngFor="let record of AlluserContacts">
                    <div (click)="addFavourite(record)" *ngIf="!record.is_favourite" class="add_fav_contacts_container">
                        <img class="user_profile" alt="user_profile" height="34px" width="34px">
                        <div class="add_fav_contacts_details">
                            <div class="card_user_name">
                                {{record.first_name}} {{record.last_name}}
                            </div>
                            <div>
                                {{record.mobile_number}}
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
            <button class="close_btn" (click)="addFavPopup=false">Close</button>
        </div>
    </div>

    <div class="popup-overlay" *ngIf="viewContactPopup">
        <div class="popup">
            <div class="view_contact_header">
                <img (click)="editContactPopup=true" class="edit_contact_icon" alt="edit">
                <img (click)="changefavStatus()" *ngIf="!selectedContact.is_favourite" class="unfav_contact_icon"
                    alt="edit">
                <img (click)="changefavStatus()" *ngIf="selectedContact.is_favourite" class="favourites_icon" alt="edit"
                    height="20px" width="20px" style="margin-left: 10px;">
            </div>
            <div class="popup_body" style="margin-left: 0px;">
                <div style="display:flex;justify-content: center; align-items: center;">
                    <img class="user_profile" height="100px" width="100px">
                </div>
                <div style="font-weight: bold; font-size: 20px;">
                    {{selectedContact.first_name}} {{selectedContact.last_name}}
                </div>
                <div class="contact_info">
                    <div style="font-weight: bold;">
                        Contact info
                    </div>
                    <div class="contact_info_details">
                        <img class="call_icon" alt="call">
                        <div style="display: flex; flex-direction: column; align-items: flex-start; margin-left: 20px;">
                            <div>
                                {{selectedContact.mobile_number}}
                            </div>
                            <div style="margin-top: 2px; color: #4B5563">
                                Mobile
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <button class="close_btn" (click)="viewContactPopup=false">Close</button>
                <button (click)="deleteContactPopup=true" class="delete_btn">Delete</button>
            </div>
        </div>
    </div>

    <div class="popup-overlay" *ngIf="deleteContactPopup">
        <div class="popup">
            <div class="popup_header">
                Delete contact ?
            </div>
            <div class="popup_body">
                Are you sure you want to delete this contact ?
            </div>
            <button class="close_btn" (click)="deleteContactPopup=false">Cancel</button>
            <button (click)="deleteContact()" class="delete_btn">Delete</button>
        </div>
    </div>

    <div class="popup-overlay" *ngIf="logoutPopup">
        <div class="popup">
            <div class="popup_header">
                Logout ?
            </div>
            <div class="popup_body">
                Are you sure you want to Logout ?
            </div>
            <button class="close_btn" (click)="logoutPopup=false">Cancel</button>
            <button (click)="logout()" class="delete_btn">Logout</button>
        </div>
    </div>

    <div *ngIf="editContactPopup">
        <app-editcontact (editpopUpClose)="closeEditPopup()" [selectedContact]="selectedContact"></app-editcontact>
    </div>

</div>